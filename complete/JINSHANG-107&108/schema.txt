CREATE DATABASE db;
USE db;

create schema T_CHART_DETAILSTORAGE_schema
source type CSV
fields(
                "owner_num" type str,
                "deptid"    type str,
                "deptname"  type str,
                "sumdate"   type datetime format '%Y-%m-%d %H:%M:%S',
                "sumcount"  type double,
                "sumweight" type double
          )
RECORD DELIMITER "CRLF"
FIELD DELIMITER ","
TEXT QUALIFIER "DQM";
            
CREATE PARSER T_CHART_DETAILSTORAGE_parser
TYPE rcd    
SCHEMA T_CHART_DETAILSTORAGE_schema;
           
CREATE TABLE T_CHART_DETAILSTORAGE using T_CHART_DETAILSTORAGE_parser;

create statistics model T_CHART_DETAILSTORAGE_model on table T_CHART_DETAILSTORAGE
group by (sumdate,deptid,owner_num)
measures (sum(sumweight));

dataset file T_dataset
(
 schema: T_CHART_DETAILSTORAGE_schema,
 files: (
         filename: "/home/kobe/Data/T_CHART_DETAILSTORAGE.txt",
         serverid:0
         ),
 splitter: (
         block_size: 10000000
         )
);

